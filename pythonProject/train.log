nohup: ignoring input
2024-04-16 14:42:54.728185: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-04-16 14:42:54.757624: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-04-16 14:42:54.757663: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-04-16 14:42:54.758544: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-04-16 14:42:54.763148: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-04-16 14:42:55.304181: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found 709960 images belonging to 269 classes.
Found 130596 images belonging to 269 classes.
2024-04-16 14:43:08.697017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1929] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 178 MB memory:  -> device: 0, name: NVIDIA RTX A5000, pci bus id: 0000:65:00.0, compute capability: 8.6
2024-04-16 14:43:08.712587: I external/local_xla/xla/stream_executor/cuda/cuda_driver.cc:1101] failed to allocate 178.25MiB (186908672 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
Epoch 1/25
2024-04-16 14:43:19.120223: W external/local_tsl/tsl/framework/bfc_allocator.cc:485] Allocator (GPU_0_bfc) ran out of memory trying to allocate 49.00MiB (rounded to 51380224)requested by op Fill
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-04-16 14:43:19.124350: I external/local_tsl/tsl/framework/bfc_allocator.cc:1039] BFCAllocator dump for GPU_0_bfc
2024-04-16 14:43:19.124361: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (256): 	Total Chunks: 24, Chunks in use: 24. 6.0KiB allocated for chunks. 6.0KiB in use in bin. 1.2KiB client-requested in use in bin.
2024-04-16 14:43:19.124366: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (512): 	Total Chunks: 3, Chunks in use: 3. 1.5KiB allocated for chunks. 1.5KiB in use in bin. 1.5KiB client-requested in use in bin.
2024-04-16 14:43:19.124371: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (1024): 	Total Chunks: 2, Chunks in use: 2. 2.5KiB allocated for chunks. 2.5KiB in use in bin. 2.1KiB client-requested in use in bin.
2024-04-16 14:43:19.124376: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (2048): 	Total Chunks: 4, Chunks in use: 4. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.1KiB client-requested in use in bin.
2024-04-16 14:43:19.124380: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-04-16 14:43:19.124384: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-04-16 14:43:19.124388: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-04-16 14:43:19.124392: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-04-16 14:43:19.124402: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (65536): 	Total Chunks: 2, Chunks in use: 2. 144.0KiB allocated for chunks. 144.0KiB in use in bin. 144.0KiB client-requested in use in bin.
2024-04-16 14:43:19.124407: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (131072): 	Total Chunks: 1, Chunks in use: 1. 136.2KiB allocated for chunks. 136.2KiB in use in bin. 72.0KiB client-requested in use in bin.
2024-04-16 14:43:19.124411: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (262144): 	Total Chunks: 4, Chunks in use: 3. 1.30MiB allocated for chunks. 1.02MiB in use in bin. 864.0KiB client-requested in use in bin.
2024-04-16 14:43:19.124415: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (524288): 	Total Chunks: 1, Chunks in use: 1. 538.0KiB allocated for chunks. 538.0KiB in use in bin. 538.0KiB client-requested in use in bin.
2024-04-16 14:43:19.124419: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-04-16 14:43:19.124423: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-04-16 14:43:19.124427: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-04-16 14:43:19.124431: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-04-16 14:43:19.124435: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-04-16 14:43:19.124439: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (33554432): 	Total Chunks: 1, Chunks in use: 1. 61.36MiB allocated for chunks. 61.36MiB in use in bin. 49.00MiB client-requested in use in bin.
2024-04-16 14:43:19.124444: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (67108864): 	Total Chunks: 1, Chunks in use: 1. 96.95MiB allocated for chunks. 96.95MiB in use in bin. 49.00MiB client-requested in use in bin.
2024-04-16 14:43:19.124447: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-04-16 14:43:19.124451: I external/local_tsl/tsl/framework/bfc_allocator.cc:1046] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-04-16 14:43:19.124456: I external/local_tsl/tsl/framework/bfc_allocator.cc:1062] Bin for 49.00MiB was 32.00MiB, Chunk State: 
2024-04-16 14:43:19.124460: I external/local_tsl/tsl/framework/bfc_allocator.cc:1075] Next region of size 168217856
2024-04-16 14:43:19.124466: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024000000 of size 256 next 1
2024-04-16 14:43:19.124469: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024000100 of size 1280 next 2
2024-04-16 14:43:19.124474: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024000600 of size 256 next 3
2024-04-16 14:43:19.124478: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024000700 of size 256 next 4
2024-04-16 14:43:19.124481: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024000800 of size 256 next 6
2024-04-16 14:43:19.124484: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024000900 of size 256 next 7
2024-04-16 14:43:19.124487: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024000a00 of size 256 next 5
2024-04-16 14:43:19.124497: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024000b00 of size 256 next 8
2024-04-16 14:43:19.124502: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024000c00 of size 256 next 13
2024-04-16 14:43:19.124505: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024000d00 of size 256 next 11
2024-04-16 14:43:19.124508: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024000e00 of size 256 next 12
2024-04-16 14:43:19.124512: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024000f00 of size 512 next 18
2024-04-16 14:43:19.124516: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024001100 of size 256 next 16
2024-04-16 14:43:19.124519: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024001200 of size 256 next 17
2024-04-16 14:43:19.124523: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024001300 of size 2048 next 23
2024-04-16 14:43:19.124526: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024001b00 of size 256 next 21
2024-04-16 14:43:19.124530: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024001c00 of size 256 next 22
2024-04-16 14:43:19.124534: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024001d00 of size 1280 next 24
2024-04-16 14:43:19.124537: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024002200 of size 256 next 26
2024-04-16 14:43:19.124540: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024002300 of size 256 next 29
2024-04-16 14:43:19.124543: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024002400 of size 256 next 30
2024-04-16 14:43:19.124546: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024002500 of size 256 next 31
2024-04-16 14:43:19.124549: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024002600 of size 256 next 9
2024-04-16 14:43:19.124552: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024002700 of size 3584 next 10
2024-04-16 14:43:19.124556: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024003500 of size 256 next 32
2024-04-16 14:43:19.124559: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024003600 of size 3584 next 33
2024-04-16 14:43:19.124562: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024004400 of size 3584 next 34
2024-04-16 14:43:19.124565: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024005200 of size 256 next 35
2024-04-16 14:43:19.124568: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024005300 of size 256 next 36
2024-04-16 14:43:19.124571: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024005400 of size 139520 next 15
2024-04-16 14:43:19.124575: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024027500 of size 73728 next 14
2024-04-16 14:43:19.124578: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024039500 of size 294912 next 40
2024-04-16 14:43:19.124582: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024081500 of size 512 next 41
2024-04-16 14:43:19.124585: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024081700 of size 512 next 42
2024-04-16 14:43:19.124588: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] Free  at 7f6024081900 of size 293888 next 20
2024-04-16 14:43:19.124591: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f60240c9500 of size 294912 next 19
2024-04-16 14:43:19.124594: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024111500 of size 73728 next 37
2024-04-16 14:43:19.124597: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024123500 of size 256 next 38
2024-04-16 14:43:19.124600: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024123600 of size 256 next 39
2024-04-16 14:43:19.124605: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024123700 of size 476672 next 28
2024-04-16 14:43:19.124609: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f6024197d00 of size 550912 next 27
2024-04-16 14:43:19.124612: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f602421e500 of size 101658624 next 25
2024-04-16 14:43:19.124616: I external/local_tsl/tsl/framework/bfc_allocator.cc:1095] InUse at 7f602a311500 of size 64337920 next 18446744073709551615
2024-04-16 14:43:19.124619: I external/local_tsl/tsl/framework/bfc_allocator.cc:1100]      Summary of in-use Chunks by size: 
2024-04-16 14:43:19.124623: I external/local_tsl/tsl/framework/bfc_allocator.cc:1103] 24 Chunks of size 256 totalling 6.0KiB
2024-04-16 14:43:19.124627: I external/local_tsl/tsl/framework/bfc_allocator.cc:1103] 3 Chunks of size 512 totalling 1.5KiB
2024-04-16 14:43:19.124630: I external/local_tsl/tsl/framework/bfc_allocator.cc:1103] 2 Chunks of size 1280 totalling 2.5KiB
2024-04-16 14:43:19.124633: I external/local_tsl/tsl/framework/bfc_allocator.cc:1103] 1 Chunks of size 2048 totalling 2.0KiB
2024-04-16 14:43:19.124637: I external/local_tsl/tsl/framework/bfc_allocator.cc:1103] 3 Chunks of size 3584 totalling 10.5KiB
2024-04-16 14:43:19.124641: I external/local_tsl/tsl/framework/bfc_allocator.cc:1103] 2 Chunks of size 73728 totalling 144.0KiB
2024-04-16 14:43:19.124645: I external/local_tsl/tsl/framework/bfc_allocator.cc:1103] 1 Chunks of size 139520 totalling 136.2KiB
2024-04-16 14:43:19.124648: I external/local_tsl/tsl/framework/bfc_allocator.cc:1103] 2 Chunks of size 294912 totalling 576.0KiB
2024-04-16 14:43:19.124652: I external/local_tsl/tsl/framework/bfc_allocator.cc:1103] 1 Chunks of size 476672 totalling 465.5KiB
2024-04-16 14:43:19.124655: I external/local_tsl/tsl/framework/bfc_allocator.cc:1103] 1 Chunks of size 550912 totalling 538.0KiB
2024-04-16 14:43:19.124659: I external/local_tsl/tsl/framework/bfc_allocator.cc:1103] 1 Chunks of size 64337920 totalling 61.36MiB
2024-04-16 14:43:19.124663: I external/local_tsl/tsl/framework/bfc_allocator.cc:1103] 1 Chunks of size 101658624 totalling 96.95MiB
2024-04-16 14:43:19.124666: I external/local_tsl/tsl/framework/bfc_allocator.cc:1107] Sum Total of in-use chunks: 160.14MiB
2024-04-16 14:43:19.124670: I external/local_tsl/tsl/framework/bfc_allocator.cc:1109] Total bytes in pool: 168217856 memory_limit_: 186908672 available bytes: 18690816 curr_region_allocation_bytes_: 373817344
2024-04-16 14:43:19.124676: I external/local_tsl/tsl/framework/bfc_allocator.cc:1114] Stats: 
Limit:                       186908672
InUse:                       167923968
MaxInUse:                    167923968
NumAllocs:                          69
MaxAllocSize:                101658624
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-04-16 14:43:19.124682: W external/local_tsl/tsl/framework/bfc_allocator.cc:497] ********************************xxxxxxxxxxxxxxxxxxxxxxxxxxxxx********************************xxxxxxx
2024-04-16 14:43:19.124698: W tensorflow/core/framework/op_kernel.cc:1839] OP_REQUIRES failed at constant_op.cc:176 : RESOURCE_EXHAUSTED: OOM when allocating tensor with shape[25088,512] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
Traceback (most recent call last):
  File "/home/t24112/v0.3src/ai/CNN_03.py", line 50, in <module>
    history = model.fit(
  File "/usr/local/lib/python3.9/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/usr/local/lib64/python3.9/site-packages/tensorflow/python/eager/polymorphic_function/autograph_util.py", line 52, in autograph_handler
    raise e.ag_error_metadata.to_exception(e)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: in user code:

    File "/usr/local/lib/python3.9/site-packages/keras/src/engine/training.py", line 1401, in train_function  *
        return step_function(self, iterator)
    File "/usr/local/lib/python3.9/site-packages/keras/src/engine/training.py", line 1384, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "/usr/local/lib/python3.9/site-packages/keras/src/engine/training.py", line 1373, in run_step  **
        outputs = model.train_step(data)
    File "/usr/local/lib/python3.9/site-packages/keras/src/engine/training.py", line 1154, in train_step
        self.optimizer.minimize(loss, self.trainable_variables, tape=tape)
    File "/usr/local/lib/python3.9/site-packages/keras/src/optimizers/optimizer.py", line 544, in minimize
        self.apply_gradients(grads_and_vars)
    File "/usr/local/lib/python3.9/site-packages/keras/src/optimizers/optimizer.py", line 1223, in apply_gradients
        return super().apply_gradients(grads_and_vars, name=name)
    File "/usr/local/lib/python3.9/site-packages/keras/src/optimizers/optimizer.py", line 638, in apply_gradients
        self.build(trainable_variables)
    File "/usr/local/lib/python3.9/site-packages/keras/src/optimizers/adam.py", line 150, in build
        self.add_variable_from_reference(
    File "/usr/local/lib/python3.9/site-packages/keras/src/optimizers/optimizer.py", line 1125, in add_variable_from_reference
        return super().add_variable_from_reference(
    File "/usr/local/lib/python3.9/site-packages/keras/src/optimizers/optimizer.py", line 508, in add_variable_from_reference
        initial_value = tf.zeros(
    File "/usr/local/lib64/python3.9/site-packages/tensorflow/dtensor/python/api.py", line 64, in call_with_layout
        return fn(*args, **kwargs)

    ResourceExhaustedError: {{function_node __wrapped__Fill_device_/job:localhost/replica:0/task:0/device:GPU:0}} OOM when allocating tensor with shape[25088,512] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc [Op:Fill] name: 

